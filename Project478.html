<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 7.3.6.2 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="00:00:00"/>
	<style type="text/css">
		@page { size: 8.5in 11in; margin: 0.79in }
		p { line-height: 115%; margin-bottom: 0.1in; background: transparent }
		pre { font-family: "Liberation Mono", monospace; font-size: 10pt; background: transparent }
	</style>
</head>
<body lang="en-US" link="#000080" vlink="#800000" dir="ltr"><pre># -*- coding: utf-8 -*-
&quot;&quot;&quot;Untitled0.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1NTTC-JSfCzF4YUcSKMZeSaJJkfim5qeE
&quot;&quot;&quot;

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

import pandas as pd
data = pd.read_csv(&quot;https://github.com/dobariadhruv/Black-Friday-Sales-Prediction/files/9996111/BlackFridaySales.csv&quot;)

data.shape

data.head()

data.describe()

data.info()

&quot;&quot;&quot;**Checking Null Value**&quot;&quot;&quot;

data.isnull().sum()

&quot;&quot;&quot;**Checking percentage of Null Value**&quot;&quot;&quot;

data.isnull().sum()/data.shape[0]*100

&quot;&quot;&quot;There are 31% null values in the Product_Category_2 and 69% null values in the Product_Category_3

**Checking Unique Value in dataset**
&quot;&quot;&quot;

data.nunique()

&quot;&quot;&quot;**Exploratory Data Analysis**

Target Variable- Purchase
&quot;&quot;&quot;

boxplot =data.boxplot(column=[&quot;Purchase&quot;,], return_type='axes')

&quot;&quot;&quot;Purchase value have some outliers and is positive skewed


&quot;&quot;&quot;

data[&quot;Purchase&quot;].skew()

data[&quot;Purchase&quot;].kurtosis()

sns.distplot(data[&quot;Purchase&quot;],color='b')
plt.title(&quot;Purchase Distribution&quot;)
plt.show()

&quot;&quot;&quot;**Age**&quot;&quot;&quot;

sns.countplot(data['Age'])
plt.title('Distribution of Age')
plt.xlabel('Different Categories of Age')
plt.show()

&quot;&quot;&quot;Age group 26-35 makes the most number of purchases.&quot;&quot;&quot;

data.groupby(&quot;Age&quot;).mean()[&quot;Purchase&quot;].plot(kind='bar')

data.groupby(&quot;Age&quot;).sum()['Purchase'].plot(kind=&quot;bar&quot;)
plt.title(&quot;Age and Purchase Analysis&quot;)
plt.show()

&quot;&quot;&quot;Total amount spent in purchase with respect to age attribute

**Gender**
&quot;&quot;&quot;

sns.countplot(data['Gender'])
plt.show()

data['Gender'].value_counts(normalize=True)*100

data.groupby(&quot;Gender&quot;).mean()[&quot;Purchase&quot;]

&quot;&quot;&quot;On average, males spend more money on purchases than females.

**Martial Status**
&quot;&quot;&quot;

sns.countplot(data['Marital_Status'])
plt.show()

data.groupby(&quot;Marital_Status&quot;).mean()[&quot;Purchase&quot;].plot(kind='bar')
plt.title(&quot;Marital_Status and Purchase Analysis&quot;)
plt.show()

&quot;&quot;&quot;Although unmarried people spend more money on purchases, the average purchase amount for married and unmarried people is the same.

**City_Category**
&quot;&quot;&quot;

sns.countplot(data['City_Category'])
plt.show()

&quot;&quot;&quot;It is observed that city category B has made the most number of puchases.

**Product_Category_1**
&quot;&quot;&quot;

plt.hist(data[&quot;Product_Category_1&quot;]) 
plt.xlabel('Product_Category_1')
plt.ylabel('Count')
plt.title('Histogram of Product_Category_1')
plt.grid(True)

&quot;&quot;&quot;Product_Category1 is right skewed&quot;&quot;&quot;

data.groupby('Product_Category_1').sum()['Purchase'].plot(kind='bar',figsize=(18,5))
plt.title(&quot;Product_Category_1 and Purchase Analysis&quot;)
plt.show()

&quot;&quot;&quot;**Product_category_2**&quot;&quot;&quot;

plt.hist(data[&quot;Product_Category_2&quot;]) 
plt.xlabel('Product_Category_2')
plt.ylabel('Count')
plt.title('Histogram of Product_Category_2')
plt.grid(True)

&quot;&quot;&quot;Product_category_3&quot;&quot;&quot;

plt.hist(data[&quot;Product_Category_3&quot;]) 
plt.xlabel('Product_Category_3')
plt.ylabel('Count')
plt.title('Histogram of Product_Category_3')
plt.grid(True)

&quot;&quot;&quot;**Stay_In_Current_City_Years**&quot;&quot;&quot;

sns.countplot(data['Stay_In_Current_City_Years'])
plt.show()

&quot;&quot;&quot;It appears that the longer someone lives in that city, the less likely they are to purchase new items. As a result, if someone is new in town and needs a lot of new things for their house, they will take advantage of the low prices on Black Friday to get everything they need.

**Correlation** **between** **varibles**
&quot;&quot;&quot;

data.corr()

sns.heatmap(data.corr(),annot=True)
plt.show()

&quot;&quot;&quot;There is a some corellation between the product category groups.

**Creating Dummy variable**
&quot;&quot;&quot;

data.columns

df = data.copy()

df = pd.get_dummies(df, columns=['Stay_In_Current_City_Years'])

df.head(10)

&quot;&quot;&quot;**Dropping the irrelevant** **columns**&quot;&quot;&quot;

df = df.drop([&quot;User_ID&quot;,&quot;Product_ID&quot;],axis=1)

&quot;&quot;&quot;**Encoding Categorical variable**&quot;&quot;&quot;

from sklearn.preprocessing import LabelEncoder
lr = LabelEncoder()
df['Gender'] = lr.fit_transform(df['Gender'])
df['Age'] = lr.fit_transform(df['Age'])
df['City_Category'] = lr.fit_transform(df['City_Category'])

df.head(5)

&quot;&quot;&quot;**Handling missing value and replacing it with mean**&quot;&quot;&quot;

mean1 = df.Product_Category_2.mean()
mean2 = df.Product_Category_3.mean()
df['Product_Category_2'] =df['Product_Category_2'].fillna(mean1).astype('int64')
df['Product_Category_3'] =df['Product_Category_3'].fillna(mean2).astype('int64')

df.isnull().sum()

df.info()

&quot;&quot;&quot;**Splitting data into training and testing sets**&quot;&quot;&quot;

X = df.drop(&quot;Purchase&quot;,axis=1)
y=df['Purchase']

from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=123)

&quot;&quot;&quot;**Linear regression**&quot;&quot;&quot;

from sklearn.linear_model import LinearRegression

# Create linear regression object
lr = LinearRegression()

# Train the model using the training set
lr.fit(X_train,y_train)

lr.intercept_

lr.coef_

y_pred = lr.predict(X_test)

from sklearn.metrics import mean_absolute_error,mean_squared_error, r2_score

mean_absolute_error(y_test, y_pred)

mean_squared_error(y_test, y_pred)

print(&quot;Accuracy of the LinearRegression model comes to be: \n &quot;)
r2_score(y_test, y_pred)

rmse_train = np.sqrt(mean_squared_error(y_test, y_pred))
print(&quot;RMSE on Test Data: &quot;, rmse_train)

&quot;&quot;&quot;**Lasso Regression**&quot;&quot;&quot;

from sklearn.linear_model import Lasso
reg2 = Lasso()

reg2.fit(X_train,y_train)

pred2 = reg2.predict(X_test)

pred2

print(&quot;Accuracy of the LassoRegression model comes to be: \n &quot;) 
print(reg2.score(X_train,y_train))

rmse_train = np.sqrt(mean_squared_error(y_test, pred2))
print(&quot;RMSE on Test Data: &quot;, rmse_train)



&quot;&quot;&quot;**Ridge Regression**&quot;&quot;&quot;

# Importing model
from sklearn.linear_model import Ridge
reg3 = Ridge()

reg3.fit(X_train, y_train)

pred3= reg3.predict(X_test)

print(&quot;Accuracy of the RidgeRegression model comes to be: \n &quot;) 
print(reg3.score(X_train,y_train))



rmse_train = np.sqrt(mean_squared_error(y_test, pred3))
print(&quot;RMSE on Test Data: &quot;, rmse_train)



&quot;&quot;&quot;**Decision Tree Regressor**&quot;&quot;&quot;

from sklearn.tree import DecisionTreeRegressor

# create a regressor object 
regressor = DecisionTreeRegressor(random_state = 0)

regressor.fit(X_train, y_train)

dt_y_pred = regressor.predict(X_test)

mean_absolute_error(y_test, dt_y_pred)

mean_squared_error(y_test, dt_y_pred)

r2_score(y_test, dt_y_pred)

print(&quot;Accuracy of the Decesion tree regressor model comes to be: \n &quot;) 
print(r2_score(y_test, dt_y_pred))

from math import sqrt
print(&quot;RMSE of Decision tree regressor Model is &quot;,sqrt(mean_squared_error(y_test, dt_y_pred)))

&quot;&quot;&quot;***Random Forest regressor***&quot;&quot;&quot;

from sklearn.ensemble import RandomForestRegressor

# create a regressor object 
RFregressor = RandomForestRegressor(random_state = 0)

RFregressor.fit(X_train, y_train)

rf_y_pred = RFregressor.predict(X_test)

mean_absolute_error(y_test, rf_y_pred)

mean_squared_error(y_test, rf_y_pred)

r2_score(y_test, rf_y_pred)

print(&quot;Accuracy of the Random Forest regressor model comes to be: \n &quot;) 
print(r2_score(y_test, rf_y_pred))

from math import sqrt
print(&quot;RMSE of Random forest regresion Model is &quot;,sqrt(mean_squared_error(y_test, rf_y_pred)))

&quot;&quot;&quot;**XGBoost Regressor**&quot;&quot;&quot;

from xgboost.sklearn import XGBRegressor
xgb_reg = XGBRegressor(learning_rate=1.0, max_depth=6, min_child_weight=40, seed=0)

xgb_reg.fit(X_train, y_train)

xgb_y_pred = xgb_reg.predict(X_test)

mean_absolute_error(y_test, xgb_y_pred)

mean_squared_error(y_test, xgb_y_pred)

r2_score(y_test, xgb_y_pred)

print(&quot;Accuracy of the XGBoost regressor model comes to be: \n &quot;) 
print(r2_score(y_test, xgb_y_pred))

from math import sqrt
print(&quot;RMSE of XGBoost Regression Model is &quot;,sqrt(mean_squared_error(y_test, xgb_y_pred)))</pre>
</body>
</html>